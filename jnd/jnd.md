## A survey on just noticeable distortion estimation and its applications in video coding


本文的主要贡献可以简要概括如下：首先，系统地回顾了JND概念的一般描述和现有的JND计算模型。其次，介绍了基于jnd的感知图像和视频编码方案的大部分相关工作，包括基于jnd的编码预处理和基于jnd的编解码器嵌入。第三，对JND估计和基于JND的PVC进行了全面的总结，并对未来可能的发展方向和机遇进行了分析和讨论。

现有的基于jnd的感知图像/视频编码方案可分为基于jnd的编码预处理和基于jnd的编解码器嵌入两大类。在基于JND的编码预处理中，根据JND模型对感知冗余进行预估。在感知质量相近的前提下，对原始图像或视频进行基于jnd的滤波平滑处理，去除感知冗余。相反，基于JND的编解码器嵌入将JND估计过程直接引入到图像/视频编码过程中，并通过对不同编码模块的感知优化大大节省了比特率。

第2节和第3节回顾了JND估计和基于JND的感知视频编码。第4节讨论了未来的方向和机会。第五部分最后对本文进行了总结


### 3.1 基于JDN的编码预处理

**背景介绍**
JND (Just Noticeable Difference): 表示人眼刚刚能够感知到的变化阈值。基于JND的预处理可以去除人类视觉系统（HVS）无法感知的冗余信息，从而减少编码数据量。
**预处理目标:**
1. 在编码之前利用JND模型移除感知冗余。
2. 提高压缩效率而不影响主观视觉质量。

根据**应用域**的不同，预处理分为 空间域的JND编码预处理 (Spatial-JND Coding Preprocessing) 和 子带域的JND编码预处理 (Subband-JND Coding Preprocessing)。


**1. 空间域的JND编码预处理 (Spatial-JND Coding Preprocessing)**

![alt text](image.png)
其中，𝐼𝑜（z）和~𝐼𝑜（z）分别为原始空间残差和过滤后的空间残差。average 𝐼𝑜（z）是8 × 8块的平均值。𝐽𝑆（z）是估计的JND阈值。根据基于空间jnd的滤波器，图像块将被平滑并去除视觉细节。

在参考论文中提到采用逐步迭代的方式完成JND值估计和冗余去除。


**2.子带域的JND编码预处理 (Subband-JND Coding Preprocessing)**

主要思路:
在频域中通过DCT（离散余弦变换）等方法分离频率分量。
根据子带域的JND阈值（如频率敏感性）去除冗余信息。

![alt text](image-1.png)

![alt text](image-2.png)

如果某个系数的绝对值小于阈值 𝑤𝑓⋅𝐽𝑓(𝑧)，则直接置为0（去除冗余）。否则，仅保留超出阈值的部分，体现了对高感知成分的保留。

**总结**
1.空间域方法更适合快速处理和对复杂场景要求不高的场合。
2.子带域方法虽然计算复杂度较高，但对高质量的压缩和复杂视频内容具有显著优势。
3.基于JND的预处理在实际应用中需要在效率与精度之间平衡。

### 3.2 Perceptual Residual Filtering（感知残差滤波）
视频编码的残差（Residual）是预测块与原始块之间的差值，表示编码后的误差信号。感知残差滤波的目标是减少残差中人眼无法察觉的信息，从而降低比特率，同时不影响感知质量。

核心思路
感知残差滤波的实现依赖于“视觉感知阈值”（JND，Just Noticeable Difference）。如果残差的幅度低于JND阈值，则意味着这些残差对于人眼不可察觉，可以直接置零以减少冗余数据。

**两种方法：**
1.Spatial-JND Residual Filtering（空间域残差滤波）：


根据像素级JND模型，幅值小于JND阈值的残差直接滤除，被滤除的残差不会影响人眼感知质量。公式如下：
![alt text](image-3.png)
其中，𝑅(𝑧)为原始残差，𝐽𝑠(𝑧)为空间域JND阈值。

2.Subband-JND Residual Filtering（子带域残差滤波）：
![alt text](image-4.png)
(同上)

作用：结合频域信息更精确地移除不可察觉的残差。
优势：保留更多关键视觉信息，但计算复杂度较高。


### 3.3 Perceptually Adaptive Quantization（感知自适应量化）

背景：量化是视频编码中的关键步骤，用于减少数据量，但可能导致失真。感知自适应量化通过引入JND模型，调整量化参数（Qstep）以最小化失真对感知质量的影响。


实现：
**1.死区量化**
量化器引入“死区”机制来忽略幅值较小的信号，公式如下：
![alt text](image-5.png)
q：量化步长。
δ：死区偏移量。

作用：减少低幅值信号占用的比特，提高压缩率。

**2.基于JND的量化优化**

通过调整每个块的量化步长，尽量接近感知失真阈值。

**3.感知自适应策略**

根据JND模型调整每个宏块的量化步长，使其动态适应场景变化。
利用块级统计信息进一步精确调整量化参数。

### 3.4 Perceptual Rate-Distortion Optimization（感知率失真优化）


1. 视觉速率失真优化
在图像和视频编码中，码率和质量是一对矛盾体，通常由编码算法和编码参数决定。一个好的编码器需要在这对矛盾中找到一个折衷策略。由于存储容量和传输带宽的限制，视频编码通常存在平均码率限制。图像 / 视频编码优化的问题是找到在平均码率限制下的最小失真，这个问题可以用以下公式表示：
![alt text](image-6.png)


通过引入拉格朗日乘子 𝜆,原问题可转化为无约束优化问题，公式为：

![alt text](image-9.png)


将失真和比特率统一到一个优化目标中，根据不同场景动态调整权重 𝜆,以实现最优的感知质量。

2. 感知失真测量
   通常，在 JND 阈值以下的失真无法被人眼感知。Yang 等人提出了一种感知失真因子，用来过滤掉那些无法被感知的失真。感知失真测量的公式如下：![alt text](image-7.png)

   基于感知失真因子，总体感知失真（SAPD）的计算公式如下：
   ![alt text](image-8.png)


   基于感知加权因子 
𝑤𝑞(𝑧)，文中定义了峰值信噪比的感知版本（PSPNR）：
![alt text](image-10.png)


3. 拉格朗日多重优化


感知速率失真优化可以通过感知失真测量和拉格朗日多重优化来实现。此外，感知 RDO（率失真优化）已经广泛应用于图像 / 视频编码模块，如预测和环路滤波等。与其他基于 JND 的 PVC 方案相比，基于 JND 的感知 RDO 对降低比特率的贡献较小。


### 4.1 Discussion about JND estimation
JND估计的相关工作分为五种类型，即像素型、子带型、块型、图片型和视频型JND估计。在JND估计中，需要解决的主要问题是弥合感知理论和JND估计建模之间的差距。从建模方法来看，现有的JND模型主要采用统计建模方法、理论建模方法和基于学习的建模方法。


**统计JND建模**：实际上，我们都知道，视觉感知特征可以定性分析，但很难量化。因此，研究人员通常会进行复杂的视觉实验来获取实验数据。基于实验数据，采用统计建模方法构建JND模型表达式，相对简单，复杂度低。然而，一方面，视觉实验容易受到实验条件的影响。另一方面，很难分析视觉感知效应之间的耦合。因此，以这种方式构建的JND模型通常存在高估和低估[33]的问题.


**理论JND建模**：理论建模方法构建的JND模型通过模拟视觉感知过程，通过引入更复杂的视觉感知效应，分析视觉感知效应之间的相关性，提高JND阈值的预测精度。近年来，自由能理论[119]和分层预测编码理论[39]相继提出被引入到大量逐像素和逐子带的JND建模中[31,33,36,37,47]。由于缺乏视觉感知过程的建模表征，这些方法无法分析不同维度视觉感知效果之间的耦合关系，相关研究有待拓展和深入.


**基于学习的JND建模**：为了避免视觉感知效果之间复杂的耦合分析，近年来建立了许多基于学习的JND模型。在基于学习的JND建模方面，近年来发布了一些压缩图像/视频数据库。然而，测试样本和测试设备总是不足的。一方面，大多数现有的JND数据库是基于压缩图像或压缩视频构建的。然而，在现实生活中，图像和视频不仅包含编码失真，还可能包含其他噪声，如高斯噪声和双极噪声。
另一方面，由于数据库的标签通常是逐图或逐视频的，因此使用基于学习的建模方法提出的JND模型可能不完全适合逐块图像或视频压缩。


### 4.3 Discussion about JND-based video coding

如第3节所述，基于jnd的图像/视频编码已经深入研究了几十年。这些研究大多集中在人类视觉单个编码模块的感知编码优化上。因此，我们将从人类视觉的多模块协同PVC和机器视觉的PVC探索的角度来讨论基于jnd的视频编码。


面向人类视觉的多模块协同PVC：众所周知，视频压缩是一个串行的多模块协同编码过程。因此，一些学者尝试探索多模块协同感知编码优化。例如，Yang等人[13]设计了一种用于视频编码的感知残差滤波器和感知预测方案。Luo等[106]同时对量化模块和运动矢量预测模块进行了优化。在[62]中，我们在编码器处设计了一个由量化失真控制的感知残差滤波器。此外，提出了一种基于jnd的解码器补偿方案。


这些工作证明了协同感知编码优化可以进一步提高编码效率，但这些工作并没有充分研究编码模块之间的耦合效应和失真传递效应。这种耦合效应主要来自以下两个方面。(1)多模块感知优化可能导致编码总失真超过JND阈值，导致压缩视频质量下降。(2)多模块感知优化可能会相互影响，导致整体编码增益降低。在失真传递效果方面，主要体现在模块间的连续失真传递和帧间失真传递的累积。在[126 - 128]中，学者们讨论了传统视频编码优化中的失真转移问题。然而，多模块感知编码优化一方面导致了模块间的串行失真传递，另一方面又加剧了帧间的失真积累。失真传递效应在视频感知编码中更为突出。


PVC用于机器视觉的探索：基于JRD预测，可以通过使用更合适的编码参数（如量化参数）来优化编码过程，实现比特率与机器视觉任务性能之间更好的平衡。


与JRD预测的研究一样，PVC用于机器视觉的研究也处于起步阶段。但是，实验结果表明，JRD预测在机器视觉任务的图像和视频压缩方面具有很大的潜力。在[124]中，Zhang等人发现在相同的图像分类和目标检测性能下，可以节省40.47%和22.77%的比特率。


综上所述，对于人类视觉而言，感知编码优化的发展相对成熟。由于模块间存在耦合和失真传递等问题，多模块协同感知编码优化需要进一步深入研究。探索解耦多模块协同感知编码优化策略，有望进一步提高视频压缩效率。对于机器视觉的感知编码优化的发展，它已经显示出巨大的潜力，但需要对不同的视觉任务进行更深入的研究。

